`timescale 1ns / 1ps

//-----------------------------------------------------------------------------
// Module:      divider_clk_tb
// Description: divider_clk 模块的激励测试文件
//              验证4分频和250,000分频功能。
//-----------------------------------------------------------------------------
module tb_divider_clk;

    //=========================================================================
    // 1. 定义测试信号
    //=========================================================================
    reg         tb_clk_in;
    reg         tb_rst_n;

    wire        tb_clk_div_4;
    wire        tb_clk_div_250k;

    //=========================================================================
    // 2. 实例化待测模块 (DUT)
    //=========================================================================
    divider_clk u_dut (
        .clk_in        (tb_clk_in),
        .rst_n         (tb_rst_n),
        .clk_div_4     (tb_clk_div_4),
        .clk_div_250k  (tb_clk_div_250k)
    );

    //=========================================================================
    // 3. 生成输入时钟 (100MHz, 周期=10ns)
    //=========================================================================
    initial begin
        tb_clk_in = 0;
        forever #5 tb_clk_in = ~tb_clk_in;
    end

    //=========================================================================
    // 4. 主测试逻辑
    //=========================================================================
    initial begin
        // --- 初始化 ---
        tb_rst_n = 1'b0;
        $display("=================================================================");
        $display("[%0t] Testbench Started. Applying reset...", $time);
        #100; // 保持复位100ns
        tb_rst_n = 1'b1; // 释放复位
        $display("[%0t] Reset released.", $time);
        $display("=================================================================");

        // --- 等待并观察 ---
        $display("[%0t] Waiting for 3ms to observe the slow clock (clk_div_250k)...", $time);
        $display("Expected period for clk_div_4 is 40ns.");
        $display("Expected period for clk_div_250k is 2.5ms (2,500,000ns).");
        
        // 等待3,000,000ns (即3ms)
        // 这足以让 clk_div_250k 完成一个完整周期 (2.5ms) 并开始下一个周期
        #3_000_000;

        $display("=================================================================");
        $display("[%0t] Simulation finished. Check the waveform viewer.", $time);
        $finish;
    end

    //=========================================================================
    // 5. 监视器
    //=========================================================================
    // 监控关键信号的变化，特别是慢速时钟的翻转
    initial begin
        $monitor("Time=%t ns | clk_div_4=%b, clk_div_250k=%b", 
                 $time, tb_clk_div_4, tb_clk_div_250k);
    end

endmodule
